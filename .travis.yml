language: swift
osx_image: xcode10.2

cache:
  directories:
  - Carthage

env:
  global:
    - PROJECT_NAME="MusicGeekMonthlySwift.xcodeproj"
    - SCHEME_IOS_FRAMEWORK="MusicGeekMonthly"
    - IOS_SDK=iphonesimulator12.2
    - secure: iZVwHM4PBbY/CjnrMuHwlnVVti4/HeuI50woS96Vi8ATHDq/PSH54/y/mvrGR07R/x+rCY0vZFayt4O2on0cvEOhpFuH5omFNa7FpFZhvBmcv4IZ69mpprAn1kFRXorHHDydZmU/AA+Ttw+jsI7hBUmJeNKRzN8dxMpSOITo18TwjaequAhNaBNg+U62QnlQUzCoBnckpNz64zgN3ov9HgBttpKUmU+ZVZR0eYmJFT7UCNvPqVmSLWpnZ9QO98DqTL2dKgoC/ChqfQvDNBo2aGd9SePejrQXI6cl8qDIHkJLWiZ43bgbOet0lHPr4kzhbl3ePZeeOESYqKVe3XKtq4LjqvhUwudS5hEw7olxpcSGEagVQLKWv2ekRuOwgXpGzVMsnSd+hdoAaJbQjnf5Zlz5eK+bxjEJnoHCUROtMT0OUeknL7BKJUQLXEn+nqsLcrNcIaH76KKoeolguOfICJJXzm3FeL+uTCCRrjZoc2dnHDP+tmp3+Jy9cP9JFx7syMaUZ4n7zgm3lvvYLfpAX6x+qaYGQg/BKF2pmfNYLIKpmJmj1dklnRforAuGAt/95b/aIykmJjmAttmIXC/97Lrun2+lZsTPqnuWneEE75siEfII9N49cp3sBfVbFN2ulA2Pt8OlLeuzTwxU6dgB+pE6BjmrvEroi8mKWx7TeGI=
    - secure: kO8Fz46HSAlEYkW33c/mIyv5YRzcZa89XOM2wBgycCTKPr1s7mSREVJWWd/PAYINxfeasQPB6nYbjCgQK5tOJMg2FrCkkS3qhKv/EH6wJyCCvhEu3BwWFSW/fWidqbkLINJ+6sdooEq+6jewEjYgNtwXk2oNDA7/iX0k8gDEZZCBsLLkDK7O02F7eJRRB2hFTs+B6UkPtXys6MLn80A24+xnNtrcNALZw4HZb3OWHMYMhGSpN99Be1GTZ7xwA2gpzFmrC+0eu9IZkfTBuBDrK8T9pTqs+Hx8KB0tdkKjUSvJqAu7mtbgPrXJG2MOr/7M4QG8lQSMjgbrXLGO+15L7zaTCguBmh+BbNYhWwYJKVHcEmDugWPuCBWQxOISwzW6r/R8LhSj467cPwbKaavc9S7TRR2KDkgOlOsyo9kuC0BKC5SCkXjZpAIKhUJyazb9oQkQ3AWmHK35LQhoeGntH+y3jA6QxQTz3wtzGjsR2Ksm0Q3FdcBvdgR8W1tz9F7abZnmDTNCxLQFfsSVikxTdrms3x2YD/XhHnjvH9O7ixOhjU0mw7WYQ1a8sOYA1GvlNqgMUPlqHVt6/1oeG5mmRjRAFfAfOPrE7Dhk1vk/JrdzNCAuS6ygtL5ltuJ3jSmOxyelpTaCS/op0w7qeL0oiLI1SUtn0XaDABijsWL6vwk=
  matrix:
    - DESTINATION="OS=12.2,name=iPhone X" SCHEME="$SCHEME_IOS_FRAMEWORK" SDK="$IOS_SDK"

before_install:
  - brew install carthage || true
  - brew outdated carthage || brew upgrade carthage
  - gem install xcpretty-travis-formatter --quiet

before_script:
  - cd ios/MusicGeekMonthlySwift
  - carthage bootstrap --platform iOS --no-use-binaries --cache-builds

script:
  - set -o pipefail
  - xcodebuild clean test -project "$PROJECT_NAME" -scheme "$SCHEME" -destination "$DESTINATION" -sdk "$SDK" CODE_SIGNING_REQUIRED=NO ONLY_ACTIVE_ARCH=NO | xcpretty -f `xcpretty-travis-formatter`
  